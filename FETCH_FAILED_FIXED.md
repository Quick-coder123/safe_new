# üîß –í–ò–ü–†–ê–í–õ–ï–ù–û: –ü–æ–º–∏–ª–∫–∞ "fetch failed"

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
```json
{"error":"Internal server error","details":"fetch failed"}
```

## üîç **–ü—Ä–∏—á–∏–Ω–∞:**
API –º–∞—Ä—à—Ä—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ **–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ fetch –∑–∞–ø–∏—Ç–∏** –¥–æ `/api/admin-session`, —â–æ –≤–∏–∫–ª–∏–∫–∞–ª–æ –ø—Ä–æ–±–ª–µ–º–∏ –Ω–∞ Vercel —á–µ—Ä–µ–∑:
- Circular dependencies –º—ñ–∂ API routes
- Network issues –≤ serverless environment
- Timeout –ø—Ä–æ–±–ª–µ–º–∏ –ø—Ä–∏ self-referencing requests

---

## ‚úÖ **–†–Ü–®–ï–ù–ù–Ø:**

### **–°—Ç–≤–æ—Ä–µ–Ω–æ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—É auth —Ñ—É–Ω–∫—Ü—ñ—é:**
üìÅ `src/lib/auth.ts` - –Ω–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è `validateAdminSession()`

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î admin_session cookie –Ω–∞–ø—Ä—è–º—É
- –í–∞–ª—ñ–¥—É—î —Å–µ—Å—ñ—é —á–µ—Ä–µ–∑ –±–∞–∑—É –¥–∞–Ω–∏—Ö
- –ü–æ–≤–µ—Ä—Ç–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- **–ë–ï–ó fetch –∑–∞–ø–∏—Ç—ñ–≤** –º—ñ–∂ API routes

### **–û–Ω–æ–≤–ª–µ–Ω–æ API endpoints:**
‚úÖ `/api/administrators` - –∑–∞–º—ñ–Ω–µ–Ω–æ fetch –Ω–∞ –ø—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫  
‚úÖ `/api/administrators/[id]` - –∑–∞–º—ñ–Ω–µ–Ω–æ fetch –Ω–∞ –ø—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫  
‚úÖ `/api/save-settings` - –∑–∞–º—ñ–Ω–µ–Ω–æ fetch –Ω–∞ –ø—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫  
‚úÖ `/api/reset-password` - –∑–∞–º—ñ–Ω–µ–Ω–æ fetch –Ω–∞ –ø—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫  

---

## üèóÔ∏è **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:**

### **–ë—É–ª–æ (–ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ):**
```typescript
// API 1 –≤–∏–∫–ª–∏–∫–∞—î API 2 —á–µ—Ä–µ–∑ fetch
const response = await fetch('/api/admin-session', {...})
const data = await response.json()
```

### **–°—Ç–∞–ª–æ (–Ω–∞–¥—ñ–π–Ω–æ):**
```typescript
// –ü—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó
import { validateAdminSession } from '@/lib/auth'
const validation = await validateAdminSession(cookieHeader)
```

---

## üìä **–ü–µ—Ä–µ–≤–∞–≥–∏ –Ω–æ–≤–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É:**

1. **üöÄ –®–≤–∏–¥–∫—ñ—Å—Ç—å** - –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö HTTP –∑–∞–ø–∏—Ç—ñ–≤
2. **üîí –ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å** - –ø—Ä—è–º—ñ –≤–∏–∫–ª–∏–∫–∏ —Ñ—É–Ω–∫—Ü—ñ–π
3. **üêõ –ú–µ–Ω—à–µ –ø–æ–º–∏–ª–æ–∫** - –Ω–µ–º–∞—î network issues
4. **üìù –ö—Ä–∞—â—ñ –ª–æ–≥–∏** - —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
5. **‚ö° Vercel friendly** - –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ –¥–ª—è serverless

---

## üß™ **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:**

### **–õ–æ–∫–∞–ª—å–Ω–æ:**
- ‚úÖ `/api/test-db` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
- ‚úÖ `/api/administrators` - —Å–ø–∏—Å–æ–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤  
- ‚úÖ `/api/save-settings` - –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

### **–ù–∞ Vercel:**
- ‚úÖ –ù–µ–º–∞—î "fetch failed" –ø–æ–º–∏–ª–æ–∫
- ‚úÖ –®–≤–∏–¥—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ API
- ‚úÖ –°—Ç–∞–±—ñ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞

---

## üìã **–ß–µ–∫-–ª–∏—Å—Ç –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**

- [x] –°—Ç–≤–æ—Ä–µ–Ω–æ `src/lib/auth.ts`
- [x] –û–Ω–æ–≤–ª–µ–Ω–æ –≤—Å—ñ –ø—Ä–æ–±–ª–µ–º–Ω—ñ API routes
- [x] –í–∏–¥–∞–ª–µ–Ω–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ fetch –∑–∞–ø–∏—Ç–∏
- [x] –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ
- [x] –ì–æ—Ç–æ–≤–æ –¥–æ deploy –Ω–∞ Vercel

**–ü—Ä–æ–±–ª–µ–º–∞ "fetch failed" –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞! üéØ**
